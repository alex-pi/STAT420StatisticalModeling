results_sigma1[ , 3],
sigmas[1], "beta_1 Power")
power_plot(betas_1, results_sigma1[ , 1],
results_sigma1[ , 2],
results_sigma1[ , 3],
sigmas[1], "beta_1 Power")
power_plot(betas_1, results_sigma1[ , 1],
results_sigma1[ , 2],
results_sigma1[ , 3],
sigmas[1], "beta_1 Power")
par(mfrow=c(1, 1), bg="ghostwhite")
power_plot(betas_1, results_sigma1[ , 1],
results_sigma1[ , 2],
results_sigma1[ , 3],
sigmas[1], "beta_1 Power")
par(mfrow=c(1, 1), bg="ghostwhite")
power_plot(betas_1,
results_sigma2[ , 1],
results_sigma2[ , 2],
results_sigma2[ , 3],
sigmas[2], "beta_1 Power")
par(mfrow=c(1, 1), bg="ghostwhite")
power_plot(betas_1,
results_sigma4[ , 1],
results_sigma4[ , 2],
results_sigma4[ , 3],
sigmas[1], "beta_1 Power")
par(mfrow=c(1, 1), bg="ghostwhite")
power_plot(betas_1,
results_sigma4[ , 1],
results_sigma4[ , 2],
results_sigma4[ , 3],
sigmas[3], "beta_1 Power")
par(mfrow=c(1, 1), bg="ghostwhite")
power_plot(betas_1,
results_sigma2[ , 1],
results_sigma2[ , 2],
results_sigma2[ , 3],
sigmas[2], "beta_1 Power")
par(mfrow=c(1, 1), bg="ghostwhite")
power_plot(betas_1,
results_sigma1[ , 1],
results_sigma1[ , 2],
results_sigma1[ , 3],
sigmas[1], "beta_1 Power")
par(mfrow=c(1, 1), bg="ghostwhite")
power_plot(betas_1,
results_sigma1[ , 1],
results_sigma1[ , 2],
results_sigma1[ , 3],
sigmas[1], "beta_1 Power")
par(mfrow=c(1, 1), bg="ghostwhite")
power_plot(betas_1,
results_sigma2[ , 1],
results_sigma2[ , 2],
results_sigma2[ , 3],
sigmas[2], "beta_1 Power")
par(mfrow=c(1, 1), bg="ghostwhite")
power_plot(betas_1,
results_sigma4[ , 1],
results_sigma4[ , 2],
results_sigma4[ , 3],
sigmas[3], "beta_1 Power")
# Chunk 1
p, li, td {
font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
# Chunk 2
birthday <- 19820426
set.seed(birthday)
alpha <- 0.05
num_sims <- 1000
sigmas <- c(1, 2, 4)
n_obs <- c(10, 20, 30)
betas_1 <- seq(-2, 2, 0.1)
x_values <- list(seq(0, 5, length = n_obs[1])
,seq(0, 5, length = n_obs[2])
,seq(0, 5, length = n_obs[3])
#,seq(0, 5, length = n_obs[4])
)
significance_results <- matrix(0, num_sims, length(x_values))
# a matrix where each (i,j) is the power of a beta_i given a x_values_j.
betas_by_powers <- matrix(0, length(betas_1), length(x_values))
results_by_sigma <- vector(mode = "list", length = length(sigmas))
# Chunk 3
sim_slr <- function(x, beta_0 = 0, beta_1, sigma = 1) {
n <- length(x)
epsilon <- rnorm(n = n, mean = 0, sd = sigma)
y <- beta_0 + beta_1 * x + epsilon
sim_model <- lm(y ~ x)
#print(summary(sim_model)$coef["x", "Pr(>|t|)"])
summary(sim_model)$coef["x", "Pr(>|t|)"]
}
do_prints <- FALSE
run_simulation <- function(sigma) {
# for each beta_1
for (bidx in 1:length(betas_1)) {
bi <- betas_1[bidx]
for (si in 1:num_sims) {
p_values <- sapply(x_values, sim_slr, beta_1=bi, sigma=sigma)
significance_results[si, ] <- (p_values < alpha)
if(do_prints) {
print(paste("beta_1=",bi,",sigma=", sigma, ",n_obs=",n_obs))
print(p_values)
print(p_values < alpha)
print("************************************")
}
}
powers <- colSums(significance_results) / num_sims
betas_by_powers[bidx, ] <- powers
}
betas_by_powers
}
results_sigma1 <- run_simulation(sigmas[1])
results_sigma2 <- run_simulation(sigmas[2])
results_sigma4 <- run_simulation(sigmas[3])
par(mfrow=c(1, 1), bg="ghostwhite")
power_plot(betas_1,
results_sigma1[ , 1],
results_sigma1[ , 2],
results_sigma1[ , 3],
sigmas[1], "beta_1 Power")
par(mfrow=c(1, 1), bg="ghostwhite")
power_plot(betas_1,
results_sigma2[ , 1],
results_sigma2[ , 2],
results_sigma2[ , 3],
sigmas[2], "beta_1 Power")
par(mfrow=c(1, 1), bg="ghostwhite")
power_plot(betas_1,
results_sigma4[ , 1],
results_sigma4[ , 2],
results_sigma4[ , 3],
sigmas[3], "beta_1 Power")
par(mfrow=c(1, 1), bg="ghostwhite")
power_plot(betas_1,
results_sigma1[ , 1],
results_sigma1[ , 2],
results_sigma1[ , 3],
sigmas[1], "beta_1 Power")
par(mfrow=c(1, 1), bg="ghostwhite")
power_plot(betas_1,
results_sigma2[ , 1],
results_sigma2[ , 2],
results_sigma2[ , 3],
sigmas[2], "beta_1 Power")
par(mfrow=c(1, 1), bg="ghostwhite")
power_plot(betas_1,
results_sigma4[ , 1],
results_sigma4[ , 2],
results_sigma4[ , 3],
sigmas[3], "beta_1 Power")
power_plot <- function(x, y1, y2, y3, sigma, title) {
plot(x, y1,
xlab = "beta_1 values",
ylab = paste("Signal Power (", num_sims, "simulations )"),
main = paste(title," ( sigma =", sigma,")"),
col = "darkorange",
lwd=2.5,
lty=2,
col.main='blue',
type='o')
lines(x, y2,
lwd=2.5,
lty=3,
col='cadetblue3',
type='o')
lines(x, y3,
lwd=2.5,
lty=3,
col='darkorchid4',
type='o')
legend("bottomright", c("Train", "Test", "XXX"),
lty = c(2, 3, 2.5),
lwd = 3,
col = c("darkorange", "cadetblue3", "darkorchid4"))
}
par(mfrow=c(1, 1), bg="ghostwhite")
power_plot(betas_1,
results_sigma1[ , 1],
results_sigma1[ , 2],
results_sigma1[ , 3],
sigmas[1], "beta_1 Power")
par(mfrow=c(1, 1), bg="ghostwhite")
power_plot(betas_1,
results_sigma2[ , 1],
results_sigma2[ , 2],
results_sigma2[ , 3],
sigmas[2], "beta_1 Power")
power_plot <- function(x, y1, y2, y3, sigma, title) {
plot(x, y1,
xlab = "beta_1 values",
ylab = paste("Signal Power (", num_sims, "simulations )"),
main = paste(title," ( sigma =", sigma,")"),
col = "darkorange",
lwd=2.5,
lty=2,
col.main='blue',
type='o')
lines(x, y2,
lwd=2.5,
lty=3,
col='deepskyblue4',
type='o')
lines(x, y3,
lwd=2.5,
lty=3,
col='darkorchid4',
type='o')
legend("bottomright", c("Train", "Test", "XXX"),
lty = c(2, 3, 2.5),
lwd = 3,
col = c("darkorange", "deepskyblue4", "darkorchid4"))
}
par(mfrow=c(1, 1), bg="ghostwhite")
power_plot(betas_1,
results_sigma1[ , 1],
results_sigma1[ , 2],
results_sigma1[ , 3],
sigmas[1], "beta_1 Power")
par(mfrow=c(1, 1), bg="ghostwhite")
power_plot(betas_1,
results_sigma2[ , 1],
results_sigma2[ , 2],
results_sigma2[ , 3],
sigmas[2], "beta_1 Power")
power_plot <- function(x, y1, y2, y3, sigma, title) {
plot(x, y1,
xlab = "beta_1 values",
ylab = paste("Signal Power (", num_sims, "simulations )"),
main = paste(title," ( sigma =", sigma,")"),
col = "darkorange",
lwd=2.5,
lty=2,
col.main='blue',
type='o')
lines(x, y2,
lwd=2.5,
lty=3,
col='gold3',
type='o')
lines(x, y3,
lwd=2.5,
lty=3,
col='darkorchid4',
type='o')
legend("bottomright", c("Train", "Test", "XXX"),
lty = c(2, 3, 2.5),
lwd = 3,
col = c("darkorange", "gold3", "darkorchid4"))
}
par(mfrow=c(1, 1), bg="ghostwhite")
power_plot(betas_1,
results_sigma1[ , 1],
results_sigma1[ , 2],
results_sigma1[ , 3],
sigmas[1], "beta_1 Power")
power_plot <- function(x, y1, y2, y3, sigma, title) {
plot(x, y1,
xlab = "beta_1 values",
ylab = paste("Signal Power (", num_sims, "simulations )"),
main = paste(title," ( sigma =", sigma,")"),
col = "darkorange",
lwd=2.5,
lty=2,
col.main='blue',
type='o')
lines(x, y2,
lwd=2.5,
lty=3,
col='forestgreen',
type='o')
lines(x, y3,
lwd=2.5,
lty=3,
col='darkorchid4',
type='o')
legend("bottomright", c("Train", "Test", "XXX"),
lty = c(2, 3, 2.5),
lwd = 3,
col = c("darkorange", "forestgreen", "darkorchid4"))
}
par(mfrow=c(1, 1), bg="ghostwhite")
power_plot(betas_1,
results_sigma1[ , 1],
results_sigma1[ , 2],
results_sigma1[ , 3],
sigmas[1], "beta_1 Power")
par(mfrow=c(1, 1), bg="ghostwhite")
power_plot(betas_1,
results_sigma2[ , 1],
results_sigma2[ , 2],
results_sigma2[ , 3],
sigmas[2], "beta_1 Power")
par(mfrow=c(1, 1), bg="ghostwhite")
power_plot(betas_1,
results_sigma4[ , 1],
results_sigma4[ , 2],
results_sigma4[ , 3],
sigmas[3], "beta_1 Power")
power_plot <- function(x, y1, y2, y3, sigma, title) {
plot(x, y1,
xlab = "beta_1 values",
ylab = paste("Signal Power (", num_sims, "simulations )"),
main = paste(title," ( sigma =", sigma,")"),
col = "darkorange",
lwd=2.5,
lty=2,
col.main='blue',
type='o')
lines(x, y2,
lwd=2.5,
lty=3,
col='forestgreen',
type='o')
lines(x, y3,
lwd=2.5,
lty=3,
col='darkorchid4',
type='o')
legend("bottomright", c("Train", "Test", "XXX"),
lty = c(3, 3, 3),
lwd = 3,
col = c("darkorange", "forestgreen", "darkorchid4"))
}
par(mfrow=c(1, 1), bg="ghostwhite")
power_plot(betas_1,
results_sigma1[ , 1],
results_sigma1[ , 2],
results_sigma1[ , 3],
sigmas[1], "beta_1 Power")
par(mfrow=c(1, 1), bg="ghostwhite")
power_plot(betas_1,
results_sigma2[ , 1],
results_sigma2[ , 2],
results_sigma2[ , 3],
sigmas[2], "beta_1 Power")
power_plot <- function(x, y1, y2, y3, sigma, title) {
plot(x, y1,
xlab = "beta_1 values",
ylab = paste("Signal Power (", num_sims, "simulations )"),
main = paste(title," ( sigma =", sigma,")"),
col = "darkorange",
lwd=2.5,
lty=2,
col.main='blue',
type='o')
lines(x, y2,
lwd=2.5,
lty=3,
col='forestgreen',
type='o')
lines(x, y3,
lwd=2.5,
lty=2,
col='darkorchid4',
type='o')
legend("bottomright", c("Train", "Test", "XXX"),
lty = c(3, 3, 3),
lwd = 3,
col = c("darkorange", "forestgreen", "darkorchid4"))
}
par(mfrow=c(1, 1), bg="ghostwhite")
power_plot(betas_1,
results_sigma1[ , 1],
results_sigma1[ , 2],
results_sigma1[ , 3],
sigmas[1], "beta_1 Power")
power_plot <- function(x, y1, y2, y3, sigma, title) {
plot(x, y1,
xlab = "beta_1 values",
ylab = paste("Signal Power (", num_sims, "simulations )"),
main = paste(title," ( sigma =", sigma,")"),
col = "darkorange",
lwd=2.5,
lty=2,
col.main='blue',
type='o')
lines(x, y2,
lwd=2.5,
lty=3,
col='forestgreen',
type='o')
lines(x, y3,
lwd=2.5,
lty=2,
col='darkorchid4',
type='o')
legend("bottomright", c("Train", "Test", "XXX"),
lty = c(3, 3, 3),
lwd = 3,
col = c("darkorange", "forestgreen", "darkorchid4"))
}
par(mfrow=c(1, 1), bg="ghostwhite")
power_plot(betas_1,
results_sigma1[ , 1],
results_sigma1[ , 2],
results_sigma1[ , 3],
sigmas[1], "beta_1 Power")
par(mfrow=c(1, 1), bg="ghostwhite")
power_plot(betas_1,
results_sigma2[ , 1],
results_sigma2[ , 2],
results_sigma2[ , 3],
sigmas[2], "beta_1 Power")
power_plot <- function(x, y1, y2, y3, sigma, title) {
plot(x, y1,
xlab = "beta_1 values",
ylab = paste("Signal Power (", num_sims, "simulations )"),
main = paste(title," ( sigma =", sigma,")"),
col = "darkorange",
lwd=2.5,
lty=2,
col.main='blue',
type='o')
lines(x, y2,
lwd=2.5,
lty=2,
col='forestgreen',
type='o')
lines(x, y3,
lwd=2.5,
lty=2,
col='darkorchid4',
type='o')
legend("bottomright", c("Train", "Test", "XXX"),
lty = c(3, 3, 3),
lwd = 3,
col = c("darkorange", "forestgreen", "darkorchid4"))
}
par(mfrow=c(1, 1), bg="ghostwhite")
power_plot(betas_1,
results_sigma1[ , 1],
results_sigma1[ , 2],
results_sigma1[ , 3],
sigmas[1], "beta_1 Power")
par(mfrow=c(1, 1), bg="ghostwhite")
power_plot(betas_1,
results_sigma2[ , 1],
results_sigma2[ , 2],
results_sigma2[ , 3],
sigmas[2], "beta_1 Power")
par(mfrow=c(1, 1), bg="ghostwhite")
power_plot(betas_1,
results_sigma4[ , 1],
results_sigma4[ , 2],
results_sigma4[ , 3],
sigmas[3], "beta_1 Power")
par(mfrow=c(1, 1), bg="ghostwhite")
power_plot(betas_1,
results_sigma1[ , 1],
results_sigma1[ , 2],
results_sigma1[ , 3],
sigmas[1], "beta_1 Power")
par(mfrow=c(1, 1), bg="ghostwhite")
power_plot(betas_1,
results_sigma2[ , 1],
results_sigma2[ , 2],
results_sigma2[ , 3],
sigmas[2], "beta_1 Power")
power_plot <- function(x, y1, y2, y3, sigma, title) {
plot(x, y1,
xlab = "beta_1 values",
ylab = paste("Signal Power (", num_sims, "simulations )"),
main = paste(title," ( sigma =", sigma,")"),
col = "darkorange",
lwd=2.5,
lty=2,
col.main='blue',
type='o')
lines(x, y2,
lwd=2.5,
lty=2,
col='forestgreen',
type='o')
lines(x, y3,
lwd=2.5,
lty=2,
col='darkorchid4',
type='o')
legend("bottomright",
c(paste(n_obs[1], "Observations"),
paste(n_obs[2], "Observations"),
paste(n_obs[3], "Observations")),
lty = c(3, 3, 3),
lwd = 3,
col = c("darkorange", "forestgreen", "darkorchid4"))
}
par(mfrow=c(1, 1), bg="ghostwhite")
power_plot(betas_1,
results_sigma1[ , 1],
results_sigma1[ , 2],
results_sigma1[ , 3],
sigmas[1], "beta_1 Power")
par(mfrow=c(1, 1), bg="ghostwhite")
power_plot(betas_1,
results_sigma2[ , 1],
results_sigma2[ , 2],
results_sigma2[ , 3],
sigmas[2], "beta_1 Power")
par(mfrow=c(1, 1), bg="ghostwhite")
power_plot(betas_1,
results_sigma4[ , 1],
results_sigma4[ , 2],
results_sigma4[ , 3],
sigmas[3], "beta_1 Power")
par(mfrow=c(1, 1), bg="ghostwhite")
power_plot(betas_1,
results_sigma1[ , 1],
results_sigma1[ , 2],
results_sigma1[ , 3],
sigmas[1], "beta_1 Power")
