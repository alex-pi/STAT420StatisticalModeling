+ Education
+ log(Income)) ^ 2
, data = Credit)
(mod_b <- step(mod_b_big,
direction = "backward"
, trace = 0))
diags <- diagnostics(mod_b,
detailed = TRUE, plotit = TRUE)
get_loocv_rmse(mod_b)
get_adj_r2(mod_b)
get_sw_decision(mod_b, alpha = 0.01)
get_num_params(mod_b)
mod_b_big <- lm(Balance ~ (Limit +
+ Cards
+ Age
+ Student
+ Married
+ Education
+ log(Income)) ^ 2
, data = Credit)
(mod_b <- step(mod_b_big,
direction = "backward"
, trace = 0))
diags <- diagnostics(mod_b,
detailed = TRUE, plotit = TRUE)
get_loocv_rmse(mod_b)
get_adj_r2(mod_b)
get_sw_decision(mod_b, alpha = 0.01)
get_num_params(mod_b)
get_loocv_rmse(mod_b)
get_adj_r2(mod_b)
get_sw_decision(mod_b, alpha = 0.01)
get_num_params(mod_b)
mod_b_big <- lm(Balance ~ (Limit +
+ Cards
+ Age
+ Student
+ Married
+ Education
+ log(Income)) ^ 2
, data = Credit)
mod_b <- step(mod_b_big,
direction = "backward"
, trace = 0)
diags <- diagnostics(mod_b,
detailed = TRUE, plotit = TRUE)
get_loocv_rmse(mod_b)
get_adj_r2(mod_b)
get_sw_decision(mod_b, alpha = 0.01)
get_num_params(mod_b)
mod_b
library(caret)
library(ggplot2)
data(Sacramento)
sac_data = Sacramento
sac_data$limits = factor(ifelse(sac_data$city == "SACRAMENTO", "in", "out"))
sac_data = subset(sac_data, select = -c(city, zip))
limits
library(caret)
library(ggplot2)
data(Sacramento)
sac_data = Sacramento
sac_data$limits = factor(ifelse(sac_data$city == "SACRAMENTO", "in", "out"))
sac_data = subset(sac_data, select = -c(city, zip))
qplot(y = longitude, x = latitude, data = sac_data,
col = limits, main = "Sacramento City Limits ")
?Sacramento
(add_price_mod <- lm(Balance ~ .
, data = sac_trn_data))
set.seed(420)
sac_trn_idx  = sample(nrow(sac_data), size = trunc(0.80 * nrow(sac_data)))
sac_trn_data = sac_data[sac_trn_idx, ]
sac_tst_data = sac_data[-sac_trn_idx, ]
(add_price_mod <- lm(Balance ~ .
, data = sac_trn_data))
(add_price_mod <- lm(price
~ .
, data = sac_trn_data))
(add_price_mod <- lm(price ~ .
, data = sac_trn_data))
get_loocv_rmse(add_price_mod)
hist(sac_trn_data$beds, breaks = 20,
xlab = "Income values",
border = "gray80",
col = "deepskyblue3"
)
pairs(sac_trn_data)
(mod_b1 <- step(add_price_mod,
direction = "backward"
, trace = 0))
(small_price_mod <- step(add_price_mod,
direction = "backward"
, trace = 0))
get_loocv_rmse(add_price_mod)
(add_price_mod <- lm(price ~ .
, data = sac_trn_data))
(small_price_mod <- step(add_price_mod,
direction = "backward"
, trace = 0))
get_loocv_rmse(add_price_mod)
(add_price_mod <- lm(price ~ . ^ 2
, data = sac_trn_data))
(small_price_mod <- step(add_price_mod,
direction = "backward"
, trace = 0))
get_loocv_rmse(add_price_mod)
(add_price_mod <- lm(price ~ .
, data = sac_trn_data))
(small_price_mod <- step(add_price_mod,
direction = "backward"
, trace = 0))
(trans_price_mod <- lm(price ~ I(sqft ^ 2)
+ beds
+ limits
+ type
, data = sac_trn_data))
get_loocv_rmse(trans_price_mod)
(add_price_mod <- lm(price ~ .
, data = sac_trn_data))
diags <- diagnostics(add_price_mod,
detailed = TRUE, plotit = TRUE)
(add_price_mod <- lm(price ~ . + log(sqft) - sqft
, data = sac_trn_data))
diags <- diagnostics(add_price_mod,
detailed = TRUE, plotit = TRUE)
(add_price_mod <- lm(price ~ . + sqrt(sqft) - sqft
, data = sac_trn_data))
diags <- diagnostics(add_price_mod,
detailed = TRUE, plotit = TRUE)
hist(sac_trn_data$sqft, breaks = 20,
xlab = "Income values",
border = "gray80",
col = "deepskyblue3"
)
hist(sac_trn_data$sqft, breaks = 20,
xlab = "sqft",
border = "gray80",
col = "deepskyblue3"
)
(add_price_mod <- lm(price ~ .
+ poly(sqft, degree = 3)
- sqft
, data = sac_trn_data))
diags <- diagnostics(add_price_mod,
detailed = TRUE, plotit = TRUE)
(add_price_mod <- lm(price ~
+ poly(sqft, degree = 3)
- sqft
, data = sac_trn_data))
diags <- diagnostics(add_price_mod,
detailed = TRUE, plotit = TRUE)
(add_price_mod <- lm(price ~
+ log(sqft)
, data = sac_trn_data))
diags <- diagnostics(add_price_mod,
detailed = TRUE, plotit = TRUE)
(add_price_mod <- lm(price ~
+ log(sqft) + log(beds)
, data = sac_trn_data))
diags <- diagnostics(add_price_mod,
detailed = TRUE, plotit = TRUE)
(add_price_mod <- lm(price ~
+ log(sqft) + log(beds)
+ latitude
, data = sac_trn_data))
diags <- diagnostics(add_price_mod,
detailed = TRUE, plotit = TRUE)
(add_price_mod <- lm(price ~
+ log(sqft) + log(beds)
+ latitude + longitude
, data = sac_trn_data))
diags <- diagnostics(add_price_mod,
detailed = TRUE, plotit = TRUE)
(add_price_mod <- lm(price ~
+ log(sqft) + log(beds)
+ latitude + longitude
+ limits
, data = sac_trn_data))
diags <- diagnostics(add_price_mod,
detailed = TRUE, plotit = TRUE)
diags <- diagnostics(add_price_mod,
detailed = TRUE, plotit = TRUE)
(add_price_mod <- lm(price ~
+ log(sqft) + log(beds)
+ latitude + longitude
+ limits
, data = sac_trn_data))
diags <- diagnostics(add_price_mod,
detailed = TRUE, plotit = TRUE)
get_loocv_rmse(add_price_mod)
pairs(sac_trn_data)
pairs(sac_trn_data)
(add_price_mod <- lm(price ~
+ log(sqft) + log(beds) + log(baths)
+ latitude + longitude
+ limits
, data = sac_trn_data))
diags <- diagnostics(add_price_mod,
detailed = TRUE, plotit = TRUE)
get_loocv_rmse(add_price_mod)
(add_price_mod <- lm(price ~
(sqft + I(sqft^2)
#+ I(sqft^2)
#+ log(beds)
#+ log(baths)
+ latitude
+ longitude
+ limits) ^ 2
, data = sac_trn_data))
diags <- diagnostics(add_price_mod,
detailed = TRUE, plotit = TRUE)
get_loocv_rmse(add_price_mod)
(add_price_mod <- lm(price ~
(sqft + I(sqft^3)
#+ I(sqft^2)
#+ log(beds)
#+ log(baths)
+ latitude
+ longitude
+ limits) ^ 2
, data = sac_trn_data))
diags <- diagnostics(add_price_mod,
detailed = TRUE, plotit = TRUE)
get_loocv_rmse(add_price_mod)
(add_price_mod <- lm(price ~
(sqft + I(sqft^3)
#+ I(sqft^2)
+ log(beds)
#+ log(baths)
+ latitude
+ longitude
+ limits) ^ 2
, data = sac_trn_data))
get_loocv_rmse(add_price_mod)
(add_price_mod <- lm(price ~
(sqft + I(sqft^3)
#+ I(sqft^2)
+ log(beds)
#+ log(baths)
+ latitude
+ longitude
+ limits) ^ 2
, data = sac_trn_data))
(small_price_mod <- step(add_price_mod,
direction = "backward"
, trace = 0))
get_loocv_rmse(add_price_mod)
get_loocv_rmse(small_price_mod)
(add_price_mod <- lm(price ~
(sqft + I(sqft^3)
#+ I(sqft^2)
+ log(beds)
+ log(baths)
+ latitude
+ longitude
+ limits) ^ 2
, data = sac_trn_data))
(small_price_mod <- step(add_price_mod,
direction = "backward"
, trace = 0))
get_loocv_rmse(add_price_mod)
get_loocv_rmse(small_price_mod)
(add_price_mod <- lm(price ~
(sqft + I(sqft^3)
#+ I(sqft^2)
+ log(beds)
+ log(baths)
+ latitude
+ longitude
+ limits) ^ 2
, data = sac_trn_data))
(small_price_mod <- step(add_price_mod,
direction = "backward"
, trace = 0))
get_loocv_rmse(add_price_mod)
get_loocv_rmse(small_price_mod)
(add_price_mod <- lm(price ~
#(sqft + I(sqft^3)
+ I(sqft^2)
+ log(beds)
+ log(baths)
+ latitude
+ longitude
+ limits) ^ 2
, data = sac_trn_data))
(small_price_mod <- step(add_price_mod,
direction = "backward"
, trace = 0))
get_loocv_rmse(add_price_mod)
get_loocv_rmse(small_price_mod)
(add_price_mod <- lm(price ~ (
#(sqft + I(sqft^3)
+ I(sqft^2)
+ log(beds)
+ log(baths)
+ latitude
+ longitude
+ limits) ^ 2
, data = sac_trn_data))
(small_price_mod <- step(add_price_mod,
direction = "backward"
, trace = 0))
get_loocv_rmse(add_price_mod)
get_loocv_rmse(small_price_mod)
(add_price_mod <- lm(price ~ (
+ sqft + I(sqft^3)
#+ I(sqft^2)
+ log(beds)
+ log(baths)
+ latitude
+ longitude
+ limits) ^ 2
, data = sac_trn_data))
(small_price_mod <- step(add_price_mod,
direction = "backward"
, trace = 0))
get_loocv_rmse(add_price_mod)
get_loocv_rmse(small_price_mod)
small_price_mod
(add_price_mod <- lm(price ~ (
+ sqft + I(sqft^2)
#+ I(sqft^2)
+ log(beds)
+ log(baths)
+ latitude
+ longitude
+ limits) ^ 2
, data = sac_trn_data))
(add_price_mod <- lm(price ~ (
+ sqft + I(sqft^2)
#+ I(sqft^2)
+ log(beds)
+ log(baths)
+ latitude
+ longitude
+ limits) ^ 2
, data = sac_trn_data))
(small_price_mod <- step(add_price_mod
,direction = "backward"
,k = log(nrow(sac_trn_data))
,trace = 0))
get_loocv_rmse(add_price_mod)
get_loocv_rmse(small_price_mod)
(add_price_mod <- lm(price ~ (
+ sqft + I(sqft^2)
#+ I(sqft^2)
#+ log(beds)
#+ log(baths)
+ latitude
+ longitude
+ limits) ^ 2
, data = sac_trn_data))
(small_price_mod <- step(add_price_mod
,direction = "backward"
,k = log(nrow(sac_trn_data))
,trace = 0))
get_loocv_rmse(add_price_mod)
get_loocv_rmse(small_price_mod)
(add_price_mod <- lm(price ~ (
+ sqft + I(sqft^2)
#+ I(sqft^2)
+ beds
+ baths
+ latitude
+ longitude
+ limits) ^ 2
, data = sac_trn_data))
(small_price_mod <- step(add_price_mod
,direction = "backward"
,k = log(nrow(sac_trn_data))
,trace = 0))
get_loocv_rmse(add_price_mod)
get_loocv_rmse(small_price_mod)
(add_price_mod <- lm(price ~ (
+ sqft + I(sqft^2) + I(sqft^3)
#+ I(sqft^2)
+ beds
+ baths
+ latitude
+ longitude
+ limits) ^ 2
, data = sac_trn_data))
(small_price_mod <- step(add_price_mod
,direction = "backward"
,k = log(nrow(sac_trn_data))
,trace = 0))
get_loocv_rmse(add_price_mod)
get_loocv_rmse(small_price_mod)
(add_price_mod <- lm(price ~ (
+ sqft + I(sqft^2)
+ beds
+ baths
+ latitude
+ longitude
+ limits)
, data = sac_trn_data))
(small_price_mod <- step(add_price_mod
,direction = "backward"
,k = log(nrow(sac_trn_data))
,trace = 0))
get_loocv_rmse(add_price_mod)
get_loocv_rmse(small_price_mod)
(add_price_mod <- lm(price ~ (
+ sqft + I(sqft^2)
+ beds
+ baths
+ latitude
+ longitude
+ limits) ^ 2
, data = sac_trn_data))
(small_price_mod <- step(add_price_mod
,direction = "backward"
,k = log(nrow(sac_trn_data))
,trace = 0))
get_loocv_rmse(add_price_mod)
get_loocv_rmse(small_price_mod)
pairs(sac_trn_data)
(big_price_mod <- lm(price ~ (
+ sqft + I(sqft^2)
+ beds
+ baths
+ latitude
+ longitude
+ limits) ^ 2
, data = sac_trn_data))
(bic_price_mod <- step(big_price_mod
,direction = "backward"
,k = log(nrow(sac_trn_data))
,trace = 0))
get_loocv_rmse(add_price_mod)
get_loocv_rmse(small_price_mod)
#pairs(sac_trn_data)
big_price_mod <- lm(price ~ (
+ sqft + I(sqft^2)
+ beds
+ baths
+ latitude
+ longitude
+ limits) ^ 2
, data = sac_trn_data)
bic_price_mod <- step(big_price_mod
,direction = "backward"
,k = log(nrow(sac_trn_data)
,trace = 0))
get_loocv_rmse(add_price_mod)
get_loocv_rmse(small_price_mod)
#pairs(sac_trn_data)
big_price_mod <- lm(price ~ (
+ sqft + I(sqft^2)
+ beds
+ baths
+ latitude
+ longitude
+ limits) ^ 2
, data = sac_trn_data)
bic_price_mod <- step(big_price_mod
,direction = "backward"
,k = log(nrow(sac_trn_data))
,trace = 0)
get_loocv_rmse(add_price_mod)
get_loocv_rmse(small_price_mod)
#pairs(sac_trn_data)
big_price_mod <- lm(price ~ (
+ sqft + I(sqft^2)
+ beds
+ baths
+ latitude
+ longitude
+ limits) ^ 2
, data = sac_trn_data)
bic_price_mod <- step(big_price_mod
,direction = "backward"
,k = log(nrow(sac_trn_data))
,trace = 0)
get_loocv_rmse(add_price_mod)
get_loocv_rmse(bic_price_mod)
#pairs(sac_trn_data)
big_price_mod <- lm(price ~ (
+ sqft + I(sqft^2)
+ beds
+ baths
+ latitude
+ longitude
+ limits) ^ 2
, data = sac_trn_data)
bic_price_mod <- step(big_price_mod
,direction = "backward"
,k = log(nrow(sac_trn_data))
,trace = 0)
get_loocv_rmse(bic_price_mod)
bic_price_mod
#pairs(sac_trn_data)
big_price_mod <- lm(price ~ (
+ sqft + I(sqft^2)
+ beds
+ baths
+ latitude
+ longitude
+ limits
+ type
) ^ 2
, data = sac_trn_data)
bic_price_mod <- step(big_price_mod
,direction = "backward"
,k = log(nrow(sac_trn_data))
,trace = 0)
get_loocv_rmse(bic_price_mod)
bic_price_mod
(add_balance_mod <- lm(Balance ~ . - Income + log(Income)
, data = Credit))
(small_balance_mod <- step(add_balance_mod, direction = "backward"
, trace = 0, k = log(nrow(Credit))))
