library(faraway)
library(faraway)
pairs(seatpos, col = "dodgerblue")
?seatpos
cor(seatpos)
round(cor(seatpos), 3)
hip_model <- lm(hipcenter ~ ., data = seatpos)
summary(hip_model)
ht_shoes_model = lm(HtShoes ~ . - hipcenter, data = seatpos)
summary(ht_shoes_model)$r.squared
car::vif(hip_model)
library(cat)
library(car)
install.packages(car)
car::vif(hip_model)
library(car)
vif(hip_model)
vif(hip_model)
set.seed(1337)
noise = rnorm(n = nrow(seatpos), mean = 0, sd = 5)
hip_model_noise = lm(hipcenter + noise ~ ., data = seatpos)
coef(hip_model)
coef(hip_model_noise)
plot(fitted(hip_model), fitted(hip_model_noise), col = "dodgerblue", pch = 20,
xlab = "Predicted, Without Noise", ylab = "Predicted, With Noise", cex = 1.5)
abline(a = 0, b = 1, col = "darkorange", lwd = 2)
hip_model_small = lm(hipcenter ~ Age + Arm + Ht, data = seatpos)
summary(hip_model_small)
vif(hip_model_small)
set.seed(1337)
noise = rnorm(n = nrow(seatpos), mean = 0, sd = 5)
hip_model_small_noise = lm(hipcenter + noise ~ Age + Arm + Ht, data = seatpos)
coef(hip_model_small)
coef(hip_model_small_noise)
anova(hip_model_small, hip_model)
cor(resid(ht_shoes_model_small), resid(hip_model_small))
ht_shoes_model_small = lm(HtShoes ~ Age + Arm + Ht, data = seatpos)
cor(resid(ht_shoes_model_small), resid(hip_model_small))
plot(resid(hip_model_small) ~ resid(ht_shoes_model_small),
col = "dodgerblue", pch = 20,
xlab = "Residuals, Added Predictor",
ylab = "Residuals, Original Model")
abline(h = 0, lty = 2)
abline(v = 0, lty = 2)
abline(lm(resid(hip_model_small) ~ resid(ht_shoes_model_small)),
col = "darkorange", lwd = 2)
library(faraway)
library(faraway)
pairs(seatpos, col = "dodgerblue")
hipcenter_mod = lm(hipcenter ~ ., data = seatpos)
coef(hipcenter_mod)
vif(hipcenter_mod)
library(leaps)
install.packages("leaps")
library(leaps)
all_hipcenter_mod = summary(regsubsets(hipcenter ~ ., data = seatpos))
all_hipcenter_mod
all_hipcenter_mod$which
all_hipcenter_mod$rss
all_hipcenter_mod$adjr2
which.min(all_hipcenter_mod$adjr2)
which.max(all_hipcenter_mod$adjr2)
which.max(all_hipcenter_mod$adjr2)
(best_r2_ind <- which.max(all_hipcenter_mod$adjr2))
all_hipcenter_mod$which[best_r2_ind, ]
p = length(coef(hipcenter_mod))
n = length(resid(hipcenter_mod))
hipcenter_mod_aic = n * log(all_hipcenter_mod$rss / n) + 2 * (2:p)
hipcenter_mod_aic
(hipcenter_mod_aic = n * log(all_hipcenter_mod$rss / n) + 2 * (2:p))
best_aic_ind = which.min(hipcenter_mod_aic)
all_hipcenter_mod$which[best_aic_ind,]
(best_aic_ind = which.min(hipcenter_mod_aic))
all_hipcenter_mod$which[best_aic_ind,]
hipcenter_mod_best_aic = lm(hipcenter ~ Age + Ht + Leg, data = seatpos)
extractAIC(hipcenter_mod_best_aic)
plot(hipcenter_mod_aic ~ I(2:p), ylab = "AIC", xlab = "p, number of parameters",
pch = 20, col = "dodgerblue", type = "b", cex = 2,
main = "AIC vs Model Complexity")
(hipcenter_mod_bic = n * log(all_hipcenter_mod$rss / n) + log(n) * (2:p))
which.min(hipcenter_mod_bic)
all_hipcenter_mod$which[1,]
hipcenter_mod_best_bic = lm(hipcenter ~ Ht, data = seatpos)
plot(hipcenter_mod_best_bic ~ I(2:p), ylab = "BIC", xlab = "p, number of parameters",
pch = 20, col = "dodgerblue", type = "b", cex = 2,
main = "BIC vs Model Complexity")
hipcenter_mod_best_bic = lm(hipcenter ~ Ht, data = seatpos)
plot(hipcenter_mod_best_bic ~ I(2:p), ylab = "BIC", xlab = "p, number of parameters",
pch = 20, col = "dodgerblue", type = "b", cex = 2,
main = "BIC vs Model Complexity")
plot(hipcenter_mod_bic ~ I(2:p), ylab = "BIC", xlab = "p, number of parameters",
pch = 20, col = "dodgerblue", type = "b", cex = 2,
main = "BIC vs Model Complexity")
hipcenter_mod_back_aic = step(hipcenter_mod, direction = "backward")
coef(hipcenter_mod_back_aic)
extractAIC(hipcenter_mod_back_aic)
length(resid(hipcenter_mod))
nrow(seatpos)
n * log(mean(hipcenter_mod_back_aic$residuals ^ 2)) + 2 * p
extractAIC(hipcenter_mod_back_aic)
extractAIC(hipcenter_mod_back_aic)
n * log(mean(hipcenter_mod_back_aic$residuals ^ 2)) + 2 * p
length(hipcenter_mod_back_aic$coefficients)
extractAIC(hipcenter_mod_back_aic)
p <- length(hipcenter_mod_back_aic$coefficients)
n <- nrow(seatpos)
n * log(mean(hipcenter_mod_back_aic$residuals ^ 2)) + 2 * p
extractAIC(hipcenter_mod_back_aic)
p <- length(hipcenter_mod_back_aic$coefficients)
n <- nrow(seatpos)
n * log(mean(hipcenter_mod_back_aic$residuals ^ 2)) + 2 * p
n <- nrow(seatpos)
hipcenter_mod_back_bic = step(hipcenter_mod, direction = "backward", k = log(n))
coef(hipcenter_mod_back_bic)
coef(hipcenter_mod_back_bic)
summary(hipcenter_mod)$adj.r.squared
## [1] 0.6000855
summary(hipcenter_mod_back_aic)$adj.r.squared
## [1] 0.6531427
summary(hipcenter_mod_back_bic)$adj.r.squared
## [1] 0.6244149
hipcenter_mod_start = lm(hipcenter ~ 1, data = seatpos)
hipcenter_mod_forw_aic = step(
hipcenter_mod_start,
# Max possible model
scope = hipcenter ~ Age + Weight + HtShoes + Ht + Seated + Arm + Thigh + Leg,
direction = "forward")
hipcenter_mod_forw_bic = step(
hipcenter_mod_start,
scope = hipcenter ~ Age + Weight + HtShoes + Ht + Seated + Arm + Thigh + Leg,
direction = "forward", k = log(n))
hipcenter_mod_both_aic = step(
hipcenter_mod_start,
scope = hipcenter ~ Age + Weight + HtShoes + Ht + Seated + Arm + Thigh + Leg,
direction = "both")
?vif
?mtcars
add_mod <- lm(mpg ~ ., data = mtcars)
vif(add_mod)
max(vif(add_mod))
names(summary(add_mod))
summary(add_mod)$adj.r.squared
step(add_mod, direction = "backward")
q3_mod <- step(add_mod, direction = "backward")
calc_loocv_rmse = function(model) {
sqrt(mean((resid(model) / (1 - hatvalues(model))) ^ 2))
}
calc_loocv_rmse(q3_mod)
q3_mod <- step(add_mod, direction = "backward", trace = 0)
q3_mod <- step(add_mod, direction = "backward", trace = 1)
q3_mod <- step(add_mod, direction = "backward", trace = 0)
calc_loocv_rmse = function(model) {
sqrt(mean((resid(model) / (1 - hatvalues(model))) ^ 2))
}
calc_loocv_rmse(q3_mod)
q3_mod <- step(add_mod, direction = "backward")
calc_loocv_rmse = function(model) {
sqrt(mean((resid(model) / (1 - hatvalues(model))) ^ 2))
}
calc_loocv_rmse(q3_mod)
calc_loocv_rmse = function(model) {
sqrt(mean((resid(model) / (1 - hatvalues(model))) ^ 2))
}
calc_loocv_rmse(lm(mpg ~ ., data = mtcars))
calc_loocv_rmse = function(model) {
sqrt(mean((resid(model) / (1 - hatvalues(model))) ^ 2))
}
calc_loocv_rmse(add_mod)
calc_loocv_rmse = function(model) {
sqrt(mean((resid(model) / (1 - hatvalues(model))) ^ 2))
}
calc_loocv_rmse(q3_mod)
q4_mod <- step(add_mod, direction = "backward", trace = 0)
calc_loocv_rmse = function(model) {
sqrt(mean((resid(model) / (1 - hatvalues(model))) ^ 2))
}
calc_loocv_rmse(q4_mod)
vif(q4_mod)
max(vif(q4_mod))
vif(add_mod) > 5
vif(add_mod) > 5
summary(add_mod)$adj.r.squared
summary(q4_mod)$adj.r.squared
summary(add_mod)$r.squared
summary(q4_mod)$r.squared
sqrt(mean(resid(add_mod) ^ 2))
sqrt(mean(resid(q4_mod) ^ 2))
calc_loocv_rmse(add_mod)
calc_loocv_rmse(q4_mod)
q8_mod <- step(lm(y ~ 1, data = mtcars),
direction = "forward",
scope = add_mod,
k = log(nrow(mtcars)))
q8_mod <- step(lm(mpg ~ 1, data = mtcars),
direction = "forward",
scope = add_mod,
k = log(nrow(mtcars)))
q8_mod <- step(lm(mpg ~ 1, data = mtcars),
direction = "forward",
scope = ~ .,
k = log(nrow(mtcars)))
q8_mod <- step(lm(mpg ~ 1, data = mtcars),
direction = "forward",
scope = mpg ~ .,
k = log(nrow(mtcars)))
q8_mod <- step(lm(mpg ~ wt, data = mtcars),
direction = "forward",
scope = mpg ~ .,
k = log(nrow(mtcars)))
q8_mod <- step(lm(mpg ~ wt, data = mtcars),
direction = "forward",
scope = mpg ~ .)
q8_mod <- step(lm(mpg ~ 1, data = mtcars),
direction = "forward",
scope = mpg ~ .)
start_mod <- lm(mpg ~ 1, data = mtcars)
start_mod
q8_mod <- step(start_mod,
direction = "forward",
scope = mpg ~ .)
q8_mod <- step(start_mod,
direction = "backward",
scope = mpg ~ .)
start_mod <- lm(mpg ~ 1, data = mtcars)
step(add_mod, direction = "backward")
q8_mod <- step(start_mod,
direction = "backward",
scope = mpg ~ .)
q8_mod <- step(start_mod,
direction = "foward",
scope = mpg ~ .)
start_mod <- lm(mpg ~ 1, data = mtcars)
q8_mod <- step(start_mod,
direction = "forward",
scope = mpg ~ .)
hipcenter_mod_forw_aic = step(
hipcenter_mod_start,
# Max possible model
scope = hipcenter ~ Age + Weight + HtShoes + Ht + Seated + Arm + Thigh + Leg,
direction = "forward")
mpg ~ .
q8_mod$coefficients
start_mod <- lm(mpg ~ 1, data = mtcars)
q8_mod <- step(start_mod,
direction = "forward",
scope = mpg ~ .,
k = log(nrow(mtcars)))
all_mod = summary(regsubsets(mpg ~ ., data = mtcars))
all_mod
all_mod$which
extractAIC(all_mod)
extractAIC(all_mod[1])
all_mod_sum = summary(regsubsets(mpg ~ ., data = mtcars))
all_mod <- regsubsets(mpg ~ ., data = mtcars)
all_mod$which
extractAIC(all_mod[1])
extractAIC(all_mod)
all_mod
q8_mod <- step(start_mod,
direction = "forward",
scope = mpg ~ .,
k = log(nrow(mtcars)))
calc_loocv_rmse(q8_mod)
?LifeCycleSavings
add_mod <- lm(sr ~ . - ddpi, data = LifeCycleSavings)
cor_add_mod <- lm(sr ~ . - ddpi, data = LifeCycleSavings)
sr_add_mod <- lm(sr ~ . - ddpi, data = LifeCycleSavings)
ddpi_add_mod <- lm(sspi ~ . - sr, data = LifeCycleSavings)
sr_add_mod <- lm(sr ~ . - ddpi, data = LifeCycleSavings)
ddpi_add_mod <- lm(sspi ~ . - sr, data = LifeCycleSavings)
ddpi_add_mod <- lm(sspi ~ . - sr, data = LifeCycleSavings)
sr_add_mod <- lm(sr ~ . - ddpi, data = LifeCycleSavings)
ddpi_add_mod <- lm(ddpi ~ . - sr, data = LifeCycleSavings)
cor(ddpi_add_mod$residuals, sr_add_mod$residuals)
inter_mod <- lm(sr ~ . ^ 2, data = LifeCycleSavings)
inter_mod
summary(inter_mod)$adj.r.squared
inter_mod <- lm(sr ~ . ^ 2, data = LifeCycleSavings)
summary(inter_mod)$adj.r.squared
summary(inter_mod)
q12_mod <- step(inter_mod, direction = "backward",
k = log(nrow(LifeCycleSavings)))
q12_mod <- step(inter_mod, direction = "backward",
k = log(nrow(LifeCycleSavings)),
trace = 0)
coef(q12_mod)
q13_mod <- step(inter_mod, direction = "backward",
trace = 0)
coef(q13_mod)
q12_mod <- step(inter_mod, direction = "backward",
k1 = log(nrow(LifeCycleSavings)),
trace = 0)
q12_mod <- step(inter_mod, direction = "backward",
k = log(nrow(LifeCycleSavings)),
trace = 0)
q13_mod <- step(inter_mod, direction = "backward")
q12_mod <- step(inter_mod, direction = "backward",
k = log(nrow(LifeCycleSavings)),
trace = 0)
coef(q12_mod)
q13_mod <- step(inter_mod, direction = "backward", trace = 0)
coef(q13_mod)
?step
q12_mod <- step(inter_mod, direction = "backward",
k = log(nrow(LifeCycleSavings)),
trace = 0)
coef(q12_mod)
q13_mod <- step(inter_mod, direction = "backward", trace = 0)
coef(q13_mod)
nrow(LifeCycleSavings)
log(nrow(LifeCycleSavings)
)
coef(q13_mod)
calc_loocv_rmse(inter_mod)
calc_loocv_rmse(q13_mod)
calc_loocv_rmse(lm(sr ~ ., data = LifeCycleSavings))
summary(q4_mod)$adj.r.squared
start_mod <- lm(mp ~ 1, data = mtcars)
start_mod <- lm(mpg ~ 1, data = mtcars)
q8_mod <- step(start_mod,
direction = "forward",
scope = mpg ~ .,
k = log(nrow(mtcars)))
q8_mod <- step(start_mod,
direction = "forward",
scope = mpg ~ .,
k = log(nrow(mtcars)))
q8_mod$coefficients
?start_mod
?mtcars
View(mtcars)
q8_mod <- step(start_mod,
direction = "forward",
k = log(nrow(mtcars)))
q8_mod <- step(start_mod,
direction = "forward")
start_mod <- lm(mpg ~ 1, data = mtcars)
q8_mod <- step(start_mod,
direction = "forward")
step(lm(mpg ~ 1, data = mtcars),
direction = "forward",
scope = mpg ~ .,
k = log(nrow(mtcars)))
?mtcars
start_mod <- lm(mpg ~ 1, data = mtcars)
start_mod
q8_mod <- step(lm(mpg ~ 1, data = mtcars),
direction = "forward",
scope = mpg ~ .,
k = log(nrow(mtcars)))
q8_mod$coefficients
q8_mod <- step(lm(mpg ~ cyl, data = mtcars),
direction = "forward",
scope = mpg ~ .,
k = log(nrow(mtcars)))
is.factor(cyl)
is.factor(mtcars$cyl)
nrow(mtcars)
q8_mod <- step(lm(mpg ~ cyl, data = mtcars),
direction = "forward",
scope = mpg ~ .,
k = log(32))
?step
?mtcars
q8_mod <- step(lm(mpg ~ 1, data = mtcars),
direction = "forward",
scope = mpg ~ cyl + disp + hp
+ drap + wt + qsec + vs + am + gear + carb,
k = log(nrow(mtcars)))
q8_mod <- step(lm(mpg ~ 1, data = mtcars),
direction = "forward",
scope = mpg ~ cyl + disp + hp
+ drat + wt + qsec + vs + am + gear + carb,
k = log(nrow(mtcars)))
?step
dimnames(mtcars)[[2]]
(dimnames(mtcars)[[2]])[-1]
fmla <- as.formula(paste(" ~ ",paste(cnames,collapse="+")))
cnames <- (dimnames(mtcars)[[2]])[-1]
fmla <- as.formula(paste(" ~ ",paste(cnames,collapse="+")))
q8_mod <- step(lm(mpg ~ cyl, data = mtcars),
direction = "forward",
scope = list(upper=fmla,lower=~1) ,
k = log(32))
q8_mod <- step(lm(mpg ~ 1, data = mtcars),
direction = "forward",
scope = mpg ~ cyl + disp + hp
+ drat + wt + qsec + vs + am + gear + carb,
k = log(nrow(mtcars)))
q8_mod <- step(lm(mpg ~ cyl, data = mtcars),
direction = "forward",
scope = list(upper=fmla,lower=~1) ,
k = log(32))
cnames <- (dimnames(mtcars)[[2]])[-1]
fmla <- as.formula(paste(" ~ ",paste(cnames,collapse="+")))
q8_mod <- step(lm(mpg ~ cyl, data = mtcars),
direction = "forward",
scope = list(upper=fmla,lower=~1) ,
k = log(nrow(mtcars)))
